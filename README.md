![refly-cover](https://github.com/user-attachments/assets/2930c555-09a7-4ea2-a18a-2b1d8a7ef4ae)

<div align="center">

<h1 align="center" style="border-bottom: none">
    <b>
        <a href="https://www.refly.ai">Refly.AI</a><br>
    </b>
    â­ï¸  The AI Native Creation Engine â­ï¸ <br>
</h1>

Reflyæ˜¯ä¸€ä¸ªå¼€æºçš„AIåŸç”Ÿåˆ›ä½œå¼•æ“ï¼Œç”±13+é¢†å…ˆAIæ¨¡å‹é©±åŠ¨ã€‚æˆ‘ä»¬å¯¹åŸé¡¹ç›®è¿›è¡Œäº†æœ¬åœ°åŒ–æ”¹è¿›ï¼Œä½¿åµŒå…¥å‘é‡ç”Ÿæˆã€æ’åºæ¨¡å‹å’Œç½‘é¡µè§£æéƒ½èƒ½åœ¨æœ¬åœ°å®Œæˆï¼Œæå¤§é™ä½äº†éƒ¨ç½²æˆæœ¬å’Œå¤æ‚åº¦ã€‚å…¶ç›´è§‚çš„è‡ªç”±å½¢å¼ç”»å¸ƒç•Œé¢é›†æˆäº†å¤šçº¿ç¨‹å¯¹è¯ã€å¤šæ¨¡æ€è¾“å…¥ï¼ˆæ–‡æœ¬/å›¾ç‰‡/æ–‡ä»¶ï¼‰ã€RAGæ£€ç´¢ã€æµè§ˆå™¨æ‰©å±•ç½‘é¡µå‰ªè—ã€ä¸Šä¸‹æ–‡è®°å¿†ã€AIæ–‡æ¡£ç¼–è¾‘ã€ä»£ç ç”Ÿæˆï¼ˆHTML/SVG/Mermaid/Reactï¼‰å’Œç½‘ç«™å¯è§†åŒ–å¼•æ“ï¼Œèµ‹èƒ½æ‚¨è½»æ¾å°†æƒ³æ³•è½¬åŒ–ä¸ºå®Œæ•´ä½œå“ã€‚

[ğŸš€ v0.4.2 å‘å¸ƒ! ç°å·²æ”¯æŒç”»å¸ƒæ¨¡æ¿å’Œæ–‡æ¡£è¡¨æ ¼âš¡ï¸](https://docs.refly.ai/changelog/v0.4.2)

[Refly Cloud](https://refly.ai/) Â· [è‡ªæ‰˜ç®¡éƒ¨ç½²](https://docs.refly.ai/guide/self-deploy) Â· [è®ºå›](https://github.com/refly-ai/refly/discussions) Â· [Discord](https://discord.gg/bWjffrb89h) Â· [Twitter](https://x.com/reflyai) Â· [æ–‡æ¡£](https://docs.refly.ai/)

<p align="center">
    <a href="https://refly.ai" target="_blank">
        <img alt="Static Badge" src="https://img.shields.io/badge/Product-F04438"></a>
    <a href="https://refly.ai/pricing" target="_blank">
        <img alt="Static Badge" src="https://img.shields.io/badge/free-pricing?logo=free&color=%20%23155EEF&label=pricing&labelColor=%20%23528bff"></a>
    <a href="https://discord.gg/bWjffrb89h" target="_blank">
        <img alt="Discord Chat" src="https://img.shields.io/discord/1323513432686989362?label=chat&logo=discord&logoColor=white&style=flat&color=5865F2"></a>
    <a href="https://x.com/reflyai" target="_blank">
        <img alt="Static Badge" src="https://img.shields.io/twitter/follow/reflyai"></a>
    <a href="https://www.typescriptlang.org/" target="_blank">
        <img alt="TypeScript-version-icon" src="https://img.shields.io/badge/TypeScript-^5.3.3-blue"></a>
</p>

<p align="center">
  <a href="./README.md"><img alt="README in English" src="https://img.shields.io/badge/English-d9d9d9"></a>
  <a href="./README_CN.md"><img alt="ç®€ä½“ä¸­æ–‡ç‰ˆè‡ªè¿°æ–‡ä»¶" src="https://img.shields.io/badge/ç®€ä½“ä¸­æ–‡-d9d9d9"></a>
</p>

</div>

## ğŸ”¥ æœ¬åœ°åŒ–æ”¹è¿›æ ¸å¿ƒäº®ç‚¹

æˆ‘ä»¬å¯¹Reflyè¿›è¡Œäº†ä¸‰é¡¹å…³é”®æœ¬åœ°åŒ–æ”¹è¿›ï¼Œæå¤§é™ä½äº†éƒ¨ç½²æˆæœ¬ï¼Œæé«˜äº†æ•°æ®å®‰å…¨æ€§ï¼š

### 1ï¸âƒ£ é«˜ç²¾åº¦åµŒå…¥å‘é‡æœ¬åœ°ç”Ÿæˆ (1024ç»´)

- **æ›¿æ¢å¤–éƒ¨API**ï¼šä¸å†ä¾èµ–Jina/OpenAI/Fireworksç­‰ç¬¬ä¸‰æ–¹åµŒå…¥API
- **é™ä½æˆæœ¬**ï¼šæ— éœ€æ”¯ä»˜APIè°ƒç”¨è´¹ç”¨
- **æ”¹è¿›æ–‡ä»¶**ï¼š`apps/api/src/providers/embeddings/jina.ts`
- **æ”¹è¿›å†…å®¹**ï¼šå®ç°æœ¬åœ°åµŒå…¥æœåŠ¡è°ƒç”¨ï¼Œæ”¯æŒ1024ç»´é«˜ç²¾åº¦å‘é‡
- **æŠ€æœ¯äº®ç‚¹**ï¼šç»´åº¦åŒ¹é…éªŒè¯ã€æ‰¹å¤„ç†ä¼˜åŒ–ã€é”™è¯¯æ¢å¤æœºåˆ¶

### 2ï¸âƒ£ æœ¬åœ°åŒ–æ’åºæ¨¡å‹

- **æ›¿æ¢å¤–éƒ¨é‡æ’API**ï¼šä»ä¾èµ–å¤–éƒ¨é‡æ’APIè½¬ä¸ºæœ¬åœ°æœåŠ¡
- **æ¨¡å‹å‡çº§**ï¼šä½¿ç”¨`bge-reranker-v2-m3`æ¨¡å‹è¿›è¡Œé«˜ç²¾åº¦æ’åº
- **æ”¹è¿›æ–‡ä»¶**ï¼š`apps/api/src/rag/rag.service.ts`
- **æ”¹è¿›å†…å®¹**ï¼šå®ç°æœ¬åœ°xinferenceæœåŠ¡è°ƒç”¨ï¼Œä¼˜åŒ–æ’åºç­–ç•¥
- **æŠ€æœ¯äº®ç‚¹**ï¼šåŸºäºå‘é‡ç›¸ä¼¼åº¦çš„æ··åˆæ’åºï¼Œé™çº§å®¹é”™æœºåˆ¶

### 3ï¸âƒ£ æœ¬åœ°åŒ–ç½‘é¡µè§£æ

- **æ›¿æ¢å¤–éƒ¨è§£æAPI**ï¼šä»ä¾èµ–å¤–éƒ¨è§£ææœåŠ¡è½¬ä¸ºæœ¬åœ°å®ç°
- **åŒé‡å¤‡ä»½ç­–ç•¥**ï¼šPython/Trafilaturaä¸»è§£æ + Node.js/Cheerioå¤‡é€‰è§£æ
- **æ”¹è¿›æ–‡ä»¶**ï¼š`apps/api/src/knowledge/parsers/jina.parser.ts`
- **æ”¹è¿›å†…å®¹**ï¼šå®ç°æœ¬åœ°ç½‘é¡µæŠ“å–ã€è§£æå’Œå†…å®¹æå–
- **æŠ€æœ¯äº®ç‚¹**ï¼šå¤šç­–ç•¥å†…å®¹é€‰æ‹©å™¨ï¼Œæ™ºèƒ½å™ªå£°è¿‡æ»¤ï¼Œå…ƒæ•°æ®æå–

## å¿«é€Ÿå¼€å§‹

> åœ¨å®‰è£…ReflyAIä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æœºå™¨æ»¡è¶³ä»¥ä¸‹æœ€ä½ç³»ç»Ÿè¦æ±‚ï¼š
>
> CPU >= 2æ ¸
>
> å†…å­˜ >= 4GB

### ä½¿ç”¨Dockerè‡ªæ‰˜ç®¡éƒ¨ç½²

å€ŸåŠ©æœ¬åœ°åŒ–æ”¹è¿›ï¼Œæ‚¨å¯ä»¥éƒ¨ç½²åŠŸèƒ½ä¸°å¯Œä¸”å®Œå…¨æœ¬åœ°åŒ–çš„ReflyAIç‰ˆæœ¬ï¼Œæ— éœ€ä¾èµ–æ˜‚è´µçš„ç¬¬ä¸‰æ–¹APIã€‚æˆ‘ä»¬çš„å›¢é˜Ÿæ­£åœ¨åŠªåŠ›è·Ÿè¿›æœ€æ–°ç‰ˆæœ¬ã€‚

#### éƒ¨ç½²æ­¥éª¤

1. å…‹éš†ä»£ç åº“å¹¶è¿›å…¥éƒ¨ç½²ç›®å½•
```bash
git clone https://github.com/refly-ai/refly.git
cd refly/deploy/docker
```

2. å¤åˆ¶å¹¶ä¿®æ”¹ç¯å¢ƒé…ç½®æ–‡ä»¶
```bash
cp ../../apps/api/.env.example .env
```

3. ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„å‘é‡åµŒå…¥è®¾ç½®
```bash
# æ‰“å¼€.envæ–‡ä»¶å¹¶è®¾ç½®ä»¥ä¸‹å‚æ•°
EMBEDDINGS_PROVIDER=jina
EMBEDDINGS_MODEL_NAME=jina-embeddings-v3
EMBEDDINGS_DIMENSIONS=1024  # å¿…é¡»åœ¨åˆå§‹åŒ–å‰è®¾ç½®
EMBEDDINGS_BATCH_SIZE=512
REFLY_VEC_DIM=1024          # å¿…é¡»ä¸EMBEDDINGS_DIMENSIONSä¸€è‡´
```

4. ä½¿ç”¨ä¼˜åŒ–çš„Dockerfileæ„å»ºé•œåƒ
```bash
# ä½¿ç”¨ä¼˜åŒ–çš„Dockerfile.newæ›¿ä»£é»˜è®¤Dockerfile
cp ../Dockerfile.new ../Dockerfile
docker compose build
```

5. å¯åŠ¨æœåŠ¡
```bash
docker compose up -d
```

æœ‰å…³åç»­æ­¥éª¤ï¼Œè¯·è®¿é—®[è‡ªæ‰˜ç®¡éƒ¨ç½²æŒ‡å—](https://docs.refly.ai/guide/self-deploy)äº†è§£æ›´å¤šè¯¦æƒ…ã€‚

## âœ¨ å…³é”®ç‰¹æ€§

### å¤šçº¿ç¨‹å¯¹è¯ç³»ç»Ÿ
å»ºç«‹åœ¨åˆ›æ–°çš„å¤šçº¿ç¨‹æ¶æ„ä¸Šï¼Œå®ç°å¹¶è¡Œç®¡ç†ç‹¬ç«‹å¯¹è¯ä¸Šä¸‹æ–‡ã€‚é€šè¿‡é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†å’Œä¸Šä¸‹æ–‡åˆ‡æ¢æœºåˆ¶å®ç°å¤æ‚çš„Agentå·¥ä½œæµï¼Œè¶…è¶Šä¼ ç»Ÿå¯¹è¯æ¨¡å‹çš„é™åˆ¶ã€‚

### å¤šæ¨¡å‹é›†æˆæ¡†æ¶ï¼ˆæœ¬åœ°åŒ–å¢å¼ºï¼‰
- é›†æˆ13+é¢†å…ˆè¯­è¨€æ¨¡å‹ï¼ŒåŒ…æ‹¬DeepSeek R1ã€Claude 3.5 Sonnetã€Gemini 2.0å’ŒO3-mini
- **æ–°å¢ï¼šæ”¯æŒæœ¬åœ°åŒ–åµŒå…¥æ¨¡å‹ï¼Œæ— éœ€å¤–éƒ¨APIå¯†é’¥**
- **æ–°å¢ï¼šé™ä½éƒ¨ç½²æˆæœ¬ï¼Œæé«˜å¯é æ€§å’Œéšç§æ€§**
- æ”¯æŒæ¨¡å‹æ··åˆè°ƒåº¦å’Œå¹¶è¡Œå¤„ç†

### çŸ¥è¯†åº“å¼•æ“ï¼ˆæœ¬åœ°åŒ–å¢å¼ºï¼‰
- æ”¯æŒå¤šæºå¼‚æ„æ•°æ®å¯¼å…¥
- **æ–°å¢ï¼šæœ¬åœ°åŒ–RAGè¯­ä¹‰æ£€ç´¢æ¶æ„ï¼Œ1024ç»´åµŒå…¥å‘é‡**
- **æ–°å¢ï¼šæ— éœ€ä¾èµ–ç¬¬ä¸‰æ–¹åµŒå…¥æœåŠ¡ï¼Œé™ä½è¿è¥æˆæœ¬**
- æ™ºèƒ½çŸ¥è¯†å›¾è°±æ„å»º

### æ™ºèƒ½å†…å®¹æ•è·ï¼ˆæœ¬åœ°åŒ–å¢å¼ºï¼‰
- ä¸»æµå¹³å°ï¼ˆGithubã€Mediumã€Wikipediaã€Arxivï¼‰ä¸€é”®å†…å®¹æ•è·
- **æ–°å¢ï¼šæœ¬åœ°åŒ–ç½‘é¡µè§£æå’Œå†…å®¹æå–**
- æ™ºèƒ½å†…å®¹è§£æå’Œç»“æ„åŒ–
- æ·±åº¦çŸ¥è¯†åº“é›†æˆ

## ğŸ“ æŠ€æœ¯å®ç°è¯¦è§£

### 1. åµŒå…¥å‘é‡æ¨¡å‹é›†æˆ

æˆ‘ä»¬é€šè¿‡ä¿®æ”¹`JinaEmbeddings`ç±»å®ç°äº†æœ¬åœ°åµŒå…¥å‘é‡é›†æˆï¼š

```typescript
// apps/api/src/providers/embeddings/jina.ts
export class JinaEmbeddings extends Embeddings {
  private config: JinaEmbeddingsConfig;
  private readonly logger = new Logger(JinaEmbeddings.name);

  constructor(config: JinaEmbeddingsConfig) {
    super(config);
    this.config = { ...defaultConfig, ...config };
    this.logger.log(`åˆå§‹åŒ–æœ¬åœ°åµŒå…¥æ¨¡å‹æœåŠ¡ï¼Œç»´åº¦: ${this.config.dimensions}`);
  }

  private async fetch(input: string[]) {
    // è°ƒç”¨æœ¬åœ°åµŒå…¥æœåŠ¡API
    const response = await fetch(`${this.config.serverBaseUrl}/api/embed`, {
      method: 'post',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ input: input }),
    });
    
    // éªŒè¯ç»´åº¦ä¸€è‡´æ€§
    if (data.embeddings.length > 0) {
      const actualDimensions = data.embeddings[0].length;
      if (actualDimensions !== this.config.dimensions) {
        throw new Error(`ç»´åº¦ä¸åŒ¹é…! é…ç½®æœŸæœ›: ${this.config.dimensions}, å®é™…: ${actualDimensions}`);
      }
    }
    
    return {
      data: data.embeddings.map((emb: number[]) => ({ embedding: emb }))
    };
  }
}
```

**âš ï¸ é‡è¦é…ç½®**ï¼šå¿…é¡»åœ¨é¡¹ç›®åˆå§‹åŒ–å‰åœ¨.envæ–‡ä»¶ä¸­è®¾ç½®æ­£ç¡®çš„ç»´åº¦å‚æ•°
```
EMBEDDINGS_DIMENSIONS=1024
REFLY_VEC_DIM=1024  # å¿…é¡»ä¸EMBEDDINGS_DIMENSIONSä¿æŒä¸€è‡´
```

### 2. æ’åºæ¨¡å‹æœ¬åœ°åŒ–

æ’åºæ¨¡å‹ä½¿ç”¨äº†ç¡¬ç¼–ç çš„æœ¬åœ°æœåŠ¡åœ°å€ï¼š

```typescript
// apps/api/src/rag/rag.service.ts
async rerank(query: string, results: SearchResult[]) {
  // å‡†å¤‡xinferenceè¯·æ±‚è´Ÿè½½
  const payload = JSON.stringify({
    model: 'bge-reranker-v2-m3', // ä½¿ç”¨æŒ‡å®šçš„æ¨¡å‹
    query: query,
    documents: Array.from(contentMap.keys()),
  });

  // è°ƒç”¨xinferenceçš„rerank API - ç¡¬ç¼–ç åœ°å€éœ€è¦ä¿®æ”¹
  const res = await fetch('http://192.168.3.12:9997/v1/rerank', {
    method: 'post',
    headers: { 'Content-Type': 'application/json' },
    body: payload,
  });
  
  // é”™è¯¯å¤„ç†åŠç»“æœå¤„ç†...
}
```

**ä¿®æ”¹æç¤º**ï¼šå¦‚éœ€æ›´æ”¹æ’åºæœåŠ¡åœ°å€ï¼Œç›´æ¥ä¿®æ”¹ä»£ç ä¸­çš„URLã€‚å»ºè®®å°†æ­¤URLæ”¹ä¸ºç¯å¢ƒå˜é‡é…ç½®ã€‚

### 3. ç½‘é¡µè§£ææœ¬åœ°åŒ–

æˆ‘ä»¬å®ç°äº†åŒé‡å¤‡ä»½çš„ç½‘é¡µè§£æç­–ç•¥ï¼š

```typescript
// apps/api/src/knowledge/parsers/jina.parser.ts
async parse(input: string | Buffer): Promise<ParseResult> {
  const url = input.toString();

  try {
    // ä¼˜å…ˆä½¿ç”¨Python/Trafilaturaè§£æï¼ˆé«˜è´¨é‡ç»“æœï¼‰
    const isPythonReady = await this.ensureTrafilaturaScript();
    
    if (isPythonReady) {
      // ä½¿ç”¨Pythonè„šæœ¬å¤„ç†
      const process = spawn(this.pythonCommand, [this.pythonScriptPath, url]);
      // å¤„ç†è¾“å‡º...
    } else {
      // å¤‡é€‰æ–¹æ¡ˆï¼šä½¿ç”¨Node.jsè§£æ
      return this.parseWithNode(url);
    }
  } catch (error) {
    // å…œåº•ï¼šæ‰€æœ‰æ–¹æ³•å¤±è´¥åä½¿ç”¨Node.jså¤‡é€‰æ–¹æ¡ˆ
    return this.parseWithNode(url);
  }
}

// Node.jså¤‡é€‰è§£æå®ç°
async parseWithNode(url: string): Promise<ParseResult> {
  // ä½¿ç”¨axiosè·å–ç½‘é¡µå†…å®¹
  const response = await axios.get(url, {
    headers: {
      'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36...',
    },
  });
  
  const html = response.data;
  const $ = cheerio.load(html);
  
  // æ™ºèƒ½å†…å®¹æå–ç®—æ³•
  // å°è¯•å¤šç§é€‰æ‹©å™¨ç­–ç•¥æå–é«˜è´¨é‡å†…å®¹...
}
```

**åŠŸèƒ½äº®ç‚¹**ï¼š
- è‡ªåŠ¨é™çº§ï¼šä»Pythonåˆ°Node.jsçš„æ— ç¼åˆ‡æ¢
- å¤šç­–ç•¥é€‰æ‹©å™¨ï¼šç¡®ä¿å†…å®¹æå–æˆåŠŸç‡
- æ™ºèƒ½å™ªéŸ³è¿‡æ»¤ï¼šè‡ªåŠ¨æ¸…ç†å¯¼èˆªæ ã€å¹¿å‘Šç­‰

## ğŸ›£ï¸ è·¯çº¿å›¾ä¸è´¡çŒ®æŒ‡å—

æˆ‘ä»¬ä¸æ–­æ”¹è¿›Reflyï¼Œæ·»åŠ ä»¤äººå…´å¥‹çš„æ–°åŠŸèƒ½ã€‚æœ‰å…³è¯¦ç»†è·¯çº¿å›¾ï¼Œè¯·è®¿é—®[å®Œæ•´è·¯çº¿å›¾æ–‡æ¡£](https://docs.refly.ai/roadmap)ã€‚æ¬¢è¿æ‰€æœ‰å¼€å‘è€…å‚ä¸è´¡çŒ®ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„[CONTRIBUTING.md](./CONTRIBUTING.md)ã€‚

## ä¸Šæ¸¸é¡¹ç›®

æˆ‘ä»¬æ„Ÿè°¢ä»¥ä¸‹ä½¿ReflyAIæˆä¸ºå¯èƒ½çš„å¼€æºé¡¹ç›®ï¼š

1. [LangChain](https://github.com/langchain-ai/langchainjs) - ç”¨äºæ„å»ºAIåº”ç”¨ç¨‹åºçš„åº“
2. [ReactFlow](https://github.com/xyflow/xyflow) - ç”¨äºæ„å»ºå¯è§†åŒ–å·¥ä½œæµçš„åº“
3. [QDrant](https://github.com/qdrant/qdrant) - ç”¨äºæ„å»ºå‘é‡æœç´¢åŠŸèƒ½çš„åº“
4. å…¶ä»–ä¸Šæ¸¸ä¾èµ–é¡¹

## è®¸å¯è¯

æœ¬ä»“åº“æ ¹æ®[ReflyAIå¼€æºè®¸å¯è¯](./LICENSE)æˆæƒï¼Œæœ¬è´¨ä¸Šæ˜¯Apache 2.0è®¸å¯è¯åŠ ä¸Šä¸€äº›é¢å¤–é™åˆ¶ã€‚

## ğŸ“± è”ç³»ä½œè€…

å¦‚æœæ‚¨å¯¹æœ¬é¡¹ç›®æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ä½œè€…ï¼š

<div align="center">
  <img src="data/erwei.jpg" alt="å¾®ä¿¡äºŒç»´ç " width="300" />
  <p>æ‰«æä¸Šæ–¹äºŒç»´ç æ·»åŠ ä½œè€…å¾®ä¿¡</p>
</div>
